# 项目结构文档 (Feature-Sliced Design)

本目录 (`src/pages`) 不仅存放项目的页面级组件，更是实践 **模块化架构 (Feature-Sliced Design)** 的核心区域。其核心思想是：**将实现同一功能的代码组织在一起，而不是按技术类型分散在不同目录中**。

## 核心原则 (高内聚、低耦合)

我们遵循“全局共享”与“模块私有”的分离原则，并对模块内部资源进行精细化管理，以实现可扩展、可维护的架构。

### 1. 全局共享资源

这些资源与具体的业务逻辑解耦，可以在应用的任何地方复用。它们存放在 `src/` 下的根级目录中：

*   `src/ui`: 存放最基础的原子组件，如 `Button`, `Input`, `Dialog`。它们是 UI 的基础构建块。
*   `src/assets`: 存放全局静态资源，如 `icons`, `images`。
*   `src/locales`: 存放全局国际化资源。
*   `src/api`: 存放全局 API 请求。
*   `src/components`: 存放由原子组件构成的、更复杂的通用组件，如 `Chart`, `Editor`。
*   `src/hooks`: 存放通用的、与业务无关的自定义 Hooks，如 `useMediaQuery`, `useCopyToClipboard`。
*   `src/utils`: 全局工具函数。
*   `src/store`: 全局 Zustand store 的初始化或不属于任何特定模块的通用状态。
*   `src/types`: 全局共享的核心类型。
*   `src/dict`: 全局共享的字典。

### 2. 功能模块资源 (pages/*)

每个父模块（如 pages/management）是一个功能“切片(Slice)”，它包含实现自身业务所需的所有资源。

#### A. 模块的“公共层” (父模块管理)
这些资源负责组织、串联和共享，由父模块统一管理。

* 路由定义 (`routes/index.tsx`): 作为模块的“导航地图”，集中定义其下所有子模块的路由关系，对外提供单一入口。

* 共享字典 (`dict/index.ts`): 存放被模块内多个子模块共同使用的字典或常量。

#### B. 子模块的“实现层” (子模块管理)
  每个子模块（如 pages/management/system/user）都是一个高度独立的单元，遵循 “谁使用，谁拥有” 的原则。

* API 请求 (`api.ts ｜ api/*`): 封装与该子模块业务紧密相关的后端接口调用。

* 状态管理 (`store.ts ｜ store/*`): 管理该子模块独有的组件状态。

* 类型定义 (`types.ts ｜ types/*`): 定义该子模块使用的数据模型。

* 自定义 Hooks (`hooks.ts ｜ hooks/*`): 封装该子模块特有的、可复用的业务逻辑。

* 私有组件 (`components/`): 仅在该子模块内部使用的 React 组件。

* 字典 (`dict/`): 存放该模块独有的字典或常量。

## 推荐的目录结构示例

```
src/
├─ ui/                  # 1. 全局原子组件
├─ components/          # 2. 全局通用复合组件
├─ ...                 # 其他全局资源
└─ pages/               # 3. 页面级目录，功能模块的根目录
   └─ example/       # 「示例」功能模块 (父模块)
      ├─ curd/
      │  ├─ posts/       # 「文章管理」子模块 (一个高内聚、自包含的单元)
      │  │  ├─ components/    # Posts管理专用的组件 (e.g., PostsDetailCard)
      │  │  ├─ index.tsx      # 页面入口组件
      │  │  ├─ api.ts         # ✅ Posts管理相关的API (e.g., getPosts)
      │  │  ├─ hooks.ts       # ✅ Posts管理专用的Hooks (e.g., usePostsList)
      │  │  ├─ store.ts       # ✅ Posts管理相关的状态
      │  │  └─ types.ts       # ✅ Posts管理相关的类型 (e.g., interface Posts)
      │  │
      │  └─ role/       # 「角色管理」子模块 (同样自包含)
      │     ├─ index.tsx
      │     └─ api.ts
      │
      ├─ routes/          # 👈 模块的“公共层”：路由，负责串联
      │  ├─ index.ts      #    主路由文件，聚合所有子路由
      │  └─ curd.routes.ts #    按子域拆分的路由 (一个子模块下有多个子模块，可以进一步拆分，比如 posts 和 ui)
      │
      └─ dict/            # 👈 模块的“公共层”：共享资源
         └─ curd.ts     #    可被 posts 和 role 模块共用的字典
```

## 实践优势

* **高度内聚**: 修改或理解一个子功能时（如用户管理），所有相关代码都在一个目录下，无需在项目中到处跳转。

* **清晰的边界**: 模块的“公共层”(routes, dict)和子模块的“实现层”职责分明，互不干扰。

* **易于维护和扩展**:

  * 添加新功能只需创建一个新的子模块目录，并在父模块的 routes 中注册。

  * 移除功能只需删除对应子模块目录并注销路由，对其他部分影响极小。

* **清晰的代码所有权**: 在团队协作中，可以方便地将某个子模块分配给特定开发者。

## 何时应该提升资源？

当不确定某个资源是否需要共享时，默认应将其设为子模块私有。如果后续发现有多个子模块需要使用该资源，再采用“就近提升”原则，将其提升到父模块的公共层（如 dict/, utils/ 等目录中）。
